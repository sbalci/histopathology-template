
```{r}
# https://easystats.github.io/parameters/
# install.packages("devtools")
# devtools::install_github("easystats/parameters")
```

```{r}
library("parameters")
```


```{r}
library(lme4)
model <- lmer(Sepal.Width ~ Petal.Length + (1|Species), data = iris)
model_parameters(model, standardize = "refit")
```


```{r}
library(psych)

model <- psych::fa(attitude, nfactors = 3)
model_parameters(model)
```



```{r}
library(dplyr)

lm(disp ~ ., data = mtcars) %>% 
  parameters_selection() %>% 
  model_parameters()
```


```{r}
library(rstanarm)
model <- stan_glm(mpg ~ ., data = mtcars) %>% 
  parameters_selection() %>% 
  model_parameters()
```

  
```{r}
x <- rnorm(300)
describe_distribution(x)

knitr::kable(describe_distribution(rnorm(300)), digits = 1)

```



```{r}
df <- standardize(iris)
describe_distribution(df$Sepal.Length)
df <- standardize(iris)
knitr::kable(describe_distribution(df$Sepal.Length), digits = 1)

```



```{r}
df <- normalize(iris)
describe_distribution(df$Sepal.Length)
df <- normalize(iris)
knitr::kable(describe_distribution(df$Sepal.Length), digits = 1)

```


---

```{r}
# install.packages("devtools")
# devtools::install_github("easystats/report")
library(report)
```


```{r}
model <- lm(Sepal.Length ~ Species, data=iris)
report(model)
```


```{r}
# Dataframe report
report::report(iris)
```




```{r}
# Correlation report
cor.test(iris$Sepal.Length, iris$Petal.Length) %>% 
  report()
```


```{r}
# Table report for a linear model
lm(Sepal.Length ~ Petal.Length + Species, data=iris) %>% 
  report() %>% 
  to_table()
```



  

```{r}
# Full report for a Bayesian logistic mixed model with effect sizes
library(rstanarm)

stan_glmer(vs ~ mpg + (1|cyl), data=mtcars, family="binomial") %>% 
  report(standardize="full", effsize="cohen1988") %>% 
  to_fulltext()
```



---

```{r}
# devtools::install_github("easystats/see")
library("see")
```


```{r}
library(ggplot2)
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length, color = Species)) + 
    geom_point2() + theme_modern()
```

    
```{r}
library(ggplot2)
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length, color = Species)) + 
    geom_point2() + theme_lucid()
```

    
```{r}
library(rstanarm)
library(estimate)

dat <- rstanarm::stan_glm(Sepal.Width ~ poly(Petal.Length, 2), 
    data = iris) %>% estimate::estimate_link(keep_draws = TRUE, 
    length = 100, draws = 250) %>% estimate::reshape_draws()

p <- ggplot(dat, aes(x = Petal.Length, y = Draw, group = Draw_Group)) + 
    geom_line(color = "white", alpha = 0.05) + scale_x_continuous(expand = c(0, 
    0)) + scale_y_continuous(expand = c(0, 0))

p + theme_blackboard()
```




```{r}
p1 <- ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + 
    geom_boxplot() + theme_modern(axis.text.angle = 45) + scale_fill_material_d()

p2 <- ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + 
    geom_violin() + theme_modern(axis.text.angle = 45) + scale_fill_material_d(palette = "ice")

p3 <- ggplot(iris, aes(x = Petal.Length, y = Petal.Width, color = Sepal.Length)) + 
    geom_point2() + theme_modern() + scale_color_material_c(palette = "rainbow")
```

    

```{r}
p1
p2
p3
plots(p1, p2, p3, ncol = 2)
```




```{r}
plots(p1, p2, p3, ncol = 2, tags = paste("Fig. ", 1:3))
```



```{r}
normal <- ggplot(iris, aes(x = Petal.Width, y = Sepal.Length)) + 
    geom_point(size = 8, alpha = 0.3) + theme_modern()

new <- ggplot(iris, aes(x = Petal.Width, y = Sepal.Length)) + 
    geom_point2(size = 8, alpha = 0.3) + theme_modern()

plots(normal, new, ncol = 2)
```



```{r}
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) + 
    geom_violindot(fill_dots = "black") + theme_modern() + scale_fill_material_d()
```

    
    
```{r}
ggplot(iris, aes(x = Sepal.Width, y = Sepal.Length, color = Species)) + 
    geom_pooljitter(label = row.names(iris)) + scale_color_flat_d() + 
    theme_modern()
```

    

```{r}
library(bayestestR)
library(rstanarm)

model <- rstanarm::stan_glm(Sepal.Length ~ Petal.Width * Species, 
    data = iris)

result <- estimate_density(model)

plot(result)

```




```{r}
result <- p_direction(model)

plot(result) + theme_modern() + scale_fill_manual(values = c("red", 
    "green"))
```



```{r}
# see::how_to_plot(result)
```



```{r}
library(rstanarm)

model <- rstanarm::stan_glm(Sepal.Length ~ Petal.Width * Species, 
    data = iris)
result <- hdi(model, ci = c(0.5, 0.75, 0.89, 0.95))

plot(result) + theme_modern() + scale_fill_brewer(palette = "Purples", 
    direction = -1)
```



```{r}
result <- rope(model, ci = c(0.9, 0.95))

plot(result, data = model, rope_color = "red") + theme_modern() + 
    scale_fill_brewer(palette = "Greens", direction = -1)
```

    

```{r}

```

model <- rstanarm::stan_glm(mpg ~ wt + gear + cyl + disp, data = mtcars)
result <- equivalence_test(model)

plot(result) + theme_blackboard() + scale_fill_material()



```{r}

```

result <- equivalence_test(model, ci = c(0.89, 0.95))
plot(result) + theme_abyss() + scale_fill_flat()




```{r}

```

result <- bayesfactor_savagedickey(model)

plot(result) + theme_modern() + scale_color_material() + scale_fill_material()



```{r}

```

lm0 <- lm(qsec ~ 1, data = mtcars)
lm1 <- lm(qsec ~ drat, data = mtcars)
lm2 <- lm(qsec ~ wt, data = mtcars)
lm3 <- lm(qsec ~ drat + wt, data = mtcars)

result <- bayesfactor_models(lm1, lm2, lm3, denominator = lm0)

plot(result, n_pies = "one", value = "probability") + scale_fill_pizza(reverse = TRUE)




```{r}

```

plot(result, n_pies = "many", value = "BF") + scale_fill_flat(palette = "rainbow", 
    reverse = TRUE)
    






```{r}

```

library(lavaan)
library(parameters)

structure <- " visual  =~ x1 + x2 + x3
               textual =~ x4 + x5 + x6
               speed   =~ x7 + x8 + x9 "

model <- lavaan::cfa(structure, data = HolzingerSwineford1939)
params <- parameters::model_parameters(model)
plot(params)










```{r}

```

library(rstanarm)
library(estimate)

model <- stan_glm(Sepal.Width ~ Species, data = iris)

contrasts <- estimate_contrasts(model)
means <- estimate_means(model)

plot(contrasts, means) + theme_modern()


---

```{r}
# https://easystats.github.io/estimate/
# install.packages("devtools")
# devtools::install_github("easystats/estimate")
library("estimate")
```



library(rstanarm)

model <- stan_glm(Sepal.Width ~ Species, data = iris)

estimate_means(model)



estimate_contrasts(model)


model <- stan_glm(Sepal.Width ~ Species * Petal.Length, data = iris)

estimate_contrasts(model, modulate = "Petal.Length", length = 3)


estimate_slopes(model)



estimate_response(model)



model <- stan_glm(Sepal.Width ~ poly(Petal.Length, 2), data=iris)

estimate_link(model)


estimate_smooth(model)




---


# https://easystats.github.io/performance/

install.packages("devtools")
devtools::install_github("easystats/performance")

library("performance")


model <- lm(mpg ~ wt + cyl, data = mtcars)
r2(model)
#> # R2 for Linear Regression
#> 
#>        R2: 0.830
#>   adj. R2: 0.819

model <- glm(am ~ wt + cyl, data = mtcars, family = binomial)
r2(model)
#> $R2_Tjur
#> Tjur's R2 
#>    0.7051

library(MASS)
data(housing)
model <- polr(Sat ~ Infl + Type + Cont, weights = Freq, data = housing)
r2(model)
#> $R2_Nagelkerke
#> Nagelkerke's R2 
#>          0.1084



library(rstanarm)
model <- stan_glmer(Petal.Length ~ Petal.Width + (1 | Species), 
    data = iris, cores = 4)
r2(model)
#> # Bayesian R2 with Standard Error
#> 
#>   Conditional R2: 0.954 [0.002]
#>      Marginal R2: 0.410 [0.123]

library(lme4)
model <- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)
r2(model)
#> # R2 for mixed models
#> 
#>   Conditional R2: 0.799
#>      Marginal R2: 0.279


library(lme4)
model <- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)
icc(model)
#> # Intraclass Correlation Coefficient
#> 
#>      Adjusted ICC: 0.722
#>   Conditional ICC: 0.521


library(brms)
set.seed(123)
model <- brm(mpg ~ wt + (1 | cyl) + (1 + wt | gear), data = mtcars)


icc(model)
#> # Random Effect Variances and ICC
#> 
#> Conditioned on: all random effects
#> 
#> ## Variance Ratio (comparable to ICC)
#> Ratio: 0.39  CI 95%: [-0.51 0.78]
#> 
#> ## Variances of Posterior Predicted Distribution
#> Conditioned on fixed effects: 22.81  CI 95%: [ 8.50 58.48]
#> Conditioned on rand. effects: 37.66  CI 95%: [24.65 56.23]
#> 
#> ## Difference in Variances
#> Difference: 14.08  CI 95%: [-18.80 35.95]


library(glmmTMB)
data(Salamanders)
model <- glm(count ~ spp + mined, family = poisson, data = Salamanders)
check_overdispersion(model)
#> # Overdispersion test
#> 
#>        dispersion ratio =    2.946
#>   Pearson's Chi-Squared = 1873.710
#>                 p-value =  < 0.001
#> Overdispersion detected.



model <- glm(count ~ spp + mined, family = poisson, data = Salamanders)
check_zeroinflation(model)
#> # Check for zero-inflation
#> 
#>    Observed zeros: 387
#>   Predicted zeros: 298
#>             Ratio: 0.77
#> Model is underfitting zeros (probable zero-inflation).


library(lme4)
data(sleepstudy)

# prepare data
set.seed(123)
sleepstudy$mygrp <- sample(1:5, size = 180, replace = TRUE)
sleepstudy$mysubgrp <- NA
for (i in 1:5) {
    filter_group <- sleepstudy$mygrp == i
    sleepstudy$mysubgrp[filter_group] <- sample(1:30, size = sum(filter_group), 
        replace = TRUE)
}

# fit strange model
model <- lmer(Reaction ~ Days + (1 | mygrp/mysubgrp) + (1 | Subject), 
    data = sleepstudy)

check_singularity(model)
#> [1] TRUE


m1 <- lm(mpg ~ wt + cyl, data = mtcars)
model_performance(m1)


m2 <- glm(vs ~ wt + mpg, data = mtcars, family = "binomial")
model_performance(m2)


library(lme4)
m3 <- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)
model_performance(m3)



counts <- c(18, 17, 15, 20, 10, 20, 25, 13, 12)
outcome <- gl(3, 1, 9)
treatment <- gl(3, 3)
m4 <- glm(counts ~ outcome + treatment, family = poisson())

compare_performance(m1, m2, m3, m4)























